This GRCh38-ancestry-README.md file was generated on 20201022 by Jennifer McDaniel.

-------------------
GENERAL INFORMATION
-------------------

**Title of Dataset:**\
GRCh38 Ancestry Stratification BED files

**Principal Investigator:**\
Justin Zook, NIST, jzook@nist.gov

**Dataset Contact(s):**\
Justin Zook, NIST, jzook@nist.gov\

----------------------
Stratification Summary
----------------------
Local ancestry BED files for GRCh38 were generated by Rajiv McCoy and Stephanie Yan as part of the [T2T Consortium](https://sites.google.com/ucsc.edu/t2tworkinggroup). 

These files can be used as standard resource of BED files for use with GA4GH benchmarking tools such as [hap.py](https://github.com/Illumina/hap.py) to stratify true positive, false positive, and false negative variant calls into inferred patterns of local ancestry in GRCh38. Note that these exclude regions difficult for short reads and other places where ancestry could not confidently be inferred.

--------------------------
SHARING/ACCESS INFORMATION
--------------------------

#### Licenses/restrictions placed on the data, or limitations of reuse:
Publicly release data are freely available for reuse without embargo.

#### Recommended citations for the data:

Reference for stratifications:

	Aganezov, S. et al.
	A complete reference genome improves analysis of human genetic variation
	BioRxiv (2021) https://doi.org/10.1101/2021.07.12.452063

If stratifications were used in benchmarking with GA4GH/GIAB best practices or hap.py please reference:

	Krusche, P., Trigg, L., Boutros, P.C. et al.
	Best practices for benchmarking germline small-variant calls in human genomes.
	Nat Biotechnol 37, 555–560 (2019). https://doi.org/10.1038/s41587-019-0054-x

#### Links to other publicly accessible locations of the data:

[GIAB FTP URL](https://ftp://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/release/genome-stratifications/)
- Individual stratification BED files as well as zipped directories (tar.gz) of files
- stratification README
- .tsvs for benchmarking with hap.py
- MD5 checksums

[GitHub URL](https://github.com/genome-in-a-bottle/genome-stratifications/)
- stratification README
- scripts used to generate and evaluate stratification BED files
- .tsvs for benchmarking with hap.py
- MD5 checksums

[Data.nist.gov](https://doi.org/10.18434/mds2-2499)
- Zipped directories (tar.gz) of stratification BED files
- stratification README
- scripts used to generate and evaluate stratification BED files
- .tsv for benchmarking with hap.py
- MD5 checksums

--------------------
DATA & FILE OVERVIEW
--------------------
#### File List:
GRCh38_ancestry_AFR.bed.gz\
GRCh38_ancestry_AMR.bed.gz\
GRCh38_ancestry_EAS.bed.gz\
GRCh38_ancestry_EUR.bed.gz\
GRCh38_ancestry_Neanderthal.bed.gz\
GRCh38_ancestry_SAS.bed.gz

#### File Descriptions:
These regions can be used to assess accuracy of variant calls, while stratifying on inferred patterns of local ancestry in GRCh38. Specifically, we report the majority continental super-population affiliation of 1000 Genomes Project samples that most closely match GRCh38 within each reported interval. We also report intervals of putative Neanderthal-introgressed origin, based on inferred patterns of identity-by-descent with the Vindija Neanderthal genome.

Region files for the following local ancestries are provided:
- African ancestry (AFR)
- American ancestry (AMR)
- East-Asian ancestry (EAS)
- European ancestry (EUR)
- Neanderthal-introgressed ancestry (Neanderthal)
- South-Asian ancestry (SAS)

--------------------------
METHODOLOGICAL INFORMATION
--------------------------

#### Description of methods used to generate the stratifications:

**Ancestry stratifications are only provided for GRCh38**

The following excerpt is from the T2T variants paper ["A complete reference genome improves analysis of human genetic variation"](https://doi.org/10.1101/2021.07.12.452063), supplemental section *"Inference of local ancestry and Neanderthal introgression for GRCh38 and T2T-CHM13"*. This section describes the methods used to generate the local ancestry stratifications. Refer to paper for all references.

*The full description of how the local ancestries and Neanderthal introgressions were identified is reported in ["The complete sequence of a human genome"](https://doi.org/10.1101/2021.05.26.445798). Briefly, we used RFMix v2.03-r0 [66] ([rfmix](https://github.com/slowkoni/rfmix)) to infer the local ancestry of the T2T-CHM13 genome. As a set of reference samples for ancestry, we used the 2,504 individuals sequenced in the [Phase 3 release of the 1KGP](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/release/20181203_biallelic_SNV/) [18]. We assumed that T2T-CHM13 carried the reference allele at sites in the 1KGP dataset that were not called as T2T-CHM13 variants by [dipcall](https://github.com/lh3/dipcall). All CHM13 genotypes were represented as phased homozygous diploid genotypes (either reference/reference or alt/alt), which resulted in two sets of identical inferred local ancestry segments for each haplotype. We obtained a genetic map for GRCh38, originally generated on build 35 of the human reference genome by the HapMap Consortium [67], from the [Beagle resource bundle](http://bochet.gcc.biostat.washington.edu/beagle/genetic_maps/).*

*We ran RFMix with default parameters (conditional random field spacing = 50 SNPs; random forest window size = 5 SNPs), grouping the 1KGP reference panel into superpopulations (African, Ad Mixed American, East Asian, European, Southeast Asian). Because individuals with 46,XY karyotypes are haploid for variants on the X chromosome, we included only individuals with 46,XX karyotypes in the reference panel for local ancestry inference for the X chromosome. We excluded from the results regions overlapping with centromeres ([UCSC Genome Browser](https://genome.ucsc.edu/cgi-bin/hgTables)) or that were [marked as inaccessible for the 1KGP](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/working/20160622_genome_mask_GRCh38/). The non-pseudoautosomal regions (PARs) of the X chromosome were also inaccessible for this analysis due to the absence of variant calls outside the PARs.*

*Inspired by related approaches [24,68], we used an alternative strategy for local ancestry inference of GRCh38. By restricting analysis to individual clones, our approach avoids strong assumptions about the genetic map, which could produce misleading results given the artificial haplotype that we previously described. Specifically, for each clone reported in the tiling path, we extracted phased haplotypes as binary vectors of the 1KGP samples from the corresponding genomic interval. We then computed the pairwise Hamming distances between each of these reference haplotypes and the reference GRCh38 haplotype (represented as an equal-length vector of zeros). We identified the nearest-neighbor reference haplotypes to GRCh38 as those with the smallest Hamming distance, recording the superpopulation membership of each corresponding reference individual. Ancestry of the clone was then assigned as the majority superpopulation of the nearest-neighbor haplotypes, normalizing by the relative abundances of superpopulations within the entire dataset. Clones for which no superpopulation achieved the majority among the nearest neighbors were designated as ambiguous, as were clones without SNPs in the 1KGP sample (i.e., occurring within inaccessible regions of the genome).*

*To identify Neanderthal-introgressed haplotypes, we used [IBDmix](https://github.com/PrincetonUniversity/IBDmix), which detects introgressed archaic sequences in a set of individuals by identifying haplotypes that are identical-by-descent to a reference archaic sample [69]. Of the three Neanderthal individuals with available high-coverage sequences, we chose the Vindija Neanderthal as our reference archaic individual due to its inferred closest relation to the Neanderthal population that admixed with modern humans [70]. Because IBDmix identifies introgressed sequences in a set of modern samples, assumed to be from the same population, we additionally provided samples from the 1KGP as a background set of modern individuals. These samples were sequenced to 30x coverage by the New York Genome Center, and variants were called on the [GRCh38 reference](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20201028_3202_phased/) [28].*

*Because local ancestry analysis indicated that the majority of the CHM13 genome is composed of European ancestries, we used European samples as the background set of modern individuals for CHM13. For GRCh38, which comprises haplotypes from multiple populations, we identified introgressed segments by pairing it with each of the 1KGP superpopulations. In a given local ancestry tract, we only retained introgression calls from the background superpopulation matching the local ancestry in that region.*

*We required all Neanderthal-introgressed haplotypes to have a LOD score of at least 4 and a length of at least 50 kbp. As with the local ancestry segments, we removed introgressed segments within regions deemed inaccessible by the 1KGP. Because we were only able to call introgression in the 72.9% GRCh38 clones with confident ancestry assignments, we also sought to verify that GRCh38’s lower amount of introgressed sequence (26.7 Mbp, in comparison with CHM13’s 51.0 Mbp) was not an artifact of restricting our analysis to a smaller set of regions. Using the UCSC Genome Browser’s liftOver tool [71], we lifted over the boundaries of confidently assigned GRCh38 clones to T2T-CHM13, discarding the clones that failed to lift over. Within these lifted over regions, T2T-CHM13 carries 43.6 Mbp of Neanderthal-introgressed sequence, in line with our expectations due to GRCh38’s higher proportion of African ancestry.*

#### Post Processing of all files:
Post-processing for file consistency was performed and described in GitHub post-processing directory. Stratification BED(s) were post processed to remove reference Ns, specifically gaps and pseudoautosomal Y regions. The BEDs are merged and sorted and only contain chromosomes 1-22, X and Y. A file crosswalk is provided in the post-processing directory for use in correlating script file naming and files generated in post-processing.

#### Quality-Assurance of all files:
Coverage of GRCh38 was performed for each chromosome using R. We confirmed coverage was as expected. Validation of chromosome coverage can be found in the GitHub validation directory. Benchmarking of a HiFi-DeepVariant callset was also performed using stratifications with hap.py. Callset was benchmarked against the v4.2.1 GIAB benchmark set to ensure benchmarking statistics in these regions were as expected.

#### People involved with sample collection, processing, analysis and/or submission:
Rajiv McCoy, Department of Biology, Johns Hopkins University, Baltimore MD, USA\
Stephanie Yan, Department of Biology, Johns Hopkins University, Baltimore MD, USA

--------------------------
DATA-SPECIFIC INFORMATION
--------------------------

#### File structure:
All stratification files are standard 3-field BED files (chromosome, start, end) with header.

--------------------------
DATA-USE POLICY
--------------------------

This data/work was created by employees of the National Institute of Standards and Technology (NIST), an agency of the Federal Government. Pursuant to title 17 United States Code Section 105, works of NIST employees are not subject to copyright protection in the United States.  This data/work may be subject to foreign copyright.

The data/work is provided by NIST as a public service and is expressly provided “AS IS.” NIST MAKES NO WARRANTY OF ANY KIND, EXPRESS, IMPLIED OR STATUTORY, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTY OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NON-INFRINGEMENT AND DATA ACCURACY. NIST does not warrant or make any representations regarding the use of the data or the results thereof, including but not limited to the correctness, accuracy, reliability or usefulness of the data. NIST SHALL NOT BE LIABLE AND YOU HEREBY RELEASE NIST FROM LIABILITY FOR ANY INDIRECT, CONSEQUENTIAL, SPECIAL, OR INCIDENTAL DAMAGES (INCLUDING DAMAGES FOR LOSS OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, AND THE LIKE), WHETHER ARISING IN TORT, CONTRACT, OR OTHERWISE, ARISING FROM OR RELATING TO THE DATA (OR THE USE OF OR INABILITY TO USE THIS DATA), EVEN IF NIST HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

To the extent that NIST may hold copyright in countries other than the United States, you are hereby granted the non-exclusive irrevocable and unconditional right to print, publish, prepare derivative works and distribute the NIST data, in any medium, or authorize others to do so on your behalf, on a royalty-free basis throughout the world.

You may improve, modify, and create derivative works of the data or any portion of the data, and you may copy and distribute such modifications or works. Modified works should carry a notice stating that you changed the data and should note the date and nature of any such change. Please explicitly acknowledge the National Institute of Standards and Technology as the source of the data:  Data citation recommendations are provided at [here](https://www.nist.gov/open/license).

Permission to use this data is contingent upon your acceptance of the terms of this agreement and upon your providing appropriate acknowledgments of NIST’s creation of the data/work.
